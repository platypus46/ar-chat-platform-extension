{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene id="scene">
      <a-text id="title" value="title" position="0 2 -5" scale="3 3 3" color="#00FF00"></a-text>
      <a-camera></a-camera>
    </a-scene>

    <script>
      window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      const recognition = new SpeechRecognition();
      recognition.interimResults = true; // 실시간 결과
      recognition.lang = 'en'; // 영어 인식

      recognition.addEventListener('result', (e) => {
        const text = Array.from(e.results)
          .map(result => result[0].transcript)
          .join('');

        // A-Frame 엔터티의 텍스트 업데이트
        document.getElementById('title').setAttribute('value', text);
      });

      recognition.addEventListener('end', recognition.start); // 음성 인식이 끝나면 다시 시작

      // VR 모드 진입 이벤트
      document.getElementById('scene').addEventListener('enter-vr', function () {
        recognition.start(); // 음성 인식 시작
      });

      // VR 모드 종료 이벤트
      document.getElementById('scene').addEventListener('exit-vr', function () {
        recognition.stop(); // 음성 인식 중지
      });

      // 기본 상태에서도 음성 인식을 시작하려면 아래 줄을 유지
      recognition.start();
    </script>
  </body>
</html>